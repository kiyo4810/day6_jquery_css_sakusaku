/*   * jQuery Litebox - jQuery plug-in   * Beta 1r1, Released 2007.02.10   *   * Copyright (c) 2007 Daniel MacDonald (www.projectatomic.com)   * Licensed http://creativecommons.org/licenses/by-nc/2.5/   */  (function($) {  $.fn.litebox = function(o){      if (window.XMLHttpRequest && typeof(document.doctype)=='object'&& !window.opera){ //ie6+, mozilla1.0+, safari1.2+, konquerer, icab3.0+          var s = {oc:'white',oy:0.7,oz:1000,sc:'black',sw:0.8,sh:0.9,ns:2,nc:'white',nz:'0.6em',nf:'sans-serif',lu:'loading.gif',image:'IMAGE',of:'OF',close:'CLOSE',prev:'PREV',next:'NEXT',ac:'ESC',ap:'LEFT ARROW',an:'RIGHT ARROW', click:'CLICK TO SEE FULL IMAGE IN NEW WINDOW'};          if(o) $.extend(s, o);          var load = function(i, g){              var h = $(g[i]).attr('href');              $('#ss_i/img').fadeTo('normal', 0, function(){                  $('#ss_c/span:eq(1)').html(i+1);                  $('#ss_c/span:eq(3)').html(g.length);                  if (i > 0) $('#ss_p').css('display', 'block');                  else $('#ss_p').css('display', 'none');                  if (i+1 < g.length) $('#ss_n').css('display', 'block');                  else $('#ss_n').css('display', 'none');                  $('#ss_i img').bind('load', function(){                      $('#ss_i img').fadeTo('normal', 1);                  });                  resize(h);              });          };          var position = function(){              var xh = parseInt($('#ss_x').height(), 10), ww = document.documentElement.clientWidth || self.innerWidth, wh = document.documentElement.clientHeight || self.innerHeight;              $('#ss_o').css({height: wh, width: ww, top: 0, left: 0});              $('#ss_s').css({height: wh*s.sh, width: ww*s.sw, top: wh/2-wh*s.sh/2, left: ww/2-ww*s.sw/2});              $('#ss_i').css({height: wh*s.sh-2*(xh+3*s.ns), width: ww*s.sw-2*(xh+3*s.ns), top: xh+3*s.ns, left: xh+3*s.ns});              if (typeof document.body.style.maxHeight == 'undefined'){ //ie6 only                  var sx = document.documentElement.scrollLeft, sy = document.documentElement.scrollTop;                  $('#ss_o').css({position: 'absolute', top: sy, left: sx});                  $('#ss_s').css({position: 'absolute', top: wh/2-wh*s.sh/2+sy, left: ww/2-ww*s.sw/2+sx});                  $(window).bind('scroll', position);              }              resize($('#ss_i/img').attr('src'));              $(window).bind('resize', position);          };          var resize = function(src){              var img = new Image();              img.onload = function(){                  img.onload = null;                  var sw = parseInt($('#ss_i').width(), 10), sh = parseInt($('#ss_i').height(), 10), iw = img.width, ih = img.height;                  if (iw > sw) {                       ih = ih * (sw / iw);                       iw = sw;                       if (ih > sh) {                           iw = iw * (sh / ih);                           ih = sh;                       }                  } else if (ih > sh) {                      iw = iw * (sh / ih);                       ih = sh;                       if (iw > sw) {                           ih = ih * (sw / iw);                           iw = sw;                      }                  }                  $('#ss_i/img').css({height: ih, width: iw, top: sh/2-ih/2, left: sw/2-iw/2}).attr('src', src);              };              img.src = src;          };          var remove = function(){              $(window).unbind('resize').unbind('scroll');              $(document).unbind('keypress');              $('#ss_s').fadeTo('normal', 0, function(){                  $('#ss_s').remove();                  $('#ss_o').fadeTo('normal', 0, function(){                      $('#ss_o').remove();                  });              });          };          return this.each(function(){              var g = $('a', this).click(function(){                   var i = $(g).index($(this)[0]);                      var moveprev = function(){                          if (i > 0){                              i -= 1;                              load(i, g);                          }                      };                       var movenext = function(){                          if (i+1 < g.length){                              i += 1;                              load(i, g);                          }                      };                      $('body').append('<div id="ss_o"></div><div id="ss_s"><div id="ss_i"><a><img /></a></div><a id="ss_x" href=""></a><div id="ss_c"><span></span><span></span><span></span><span></span></div><a id="ss_p" href=""></a><a id="ss_n" href=""></a></div>');                       $('#ss_s').css({position: 'fixed', zIndex: s.oz+1, opacity: 0, background: s.sc});                      $('#ss_i').css({position: 'absolute', zIndex: s.oz+2, background: 'url('+s.lu+') no-repeat 50% 50%'});                      $('#ss_i/a').attr({title: s.click, href: ''}).bind('click', function(){                          var w = window.open($(g[i]).attr('href'),'liteboxwin');                          return false;                      });                      $('#ss_i img').css({position: 'absolute', zIndex: s.oz+3, opacity: 0, border: 'none'});                      $('#ss_c, #ss_s/a').css({position: 'absolute', display: 'block', color: s.nc, font: s.nz+'/1 '+s.nf, textDecoration: 'none', outline: 'none !impotant'});                      $('#ss_c').css({width: '50%', bottom: s.ns, left: '25%', textAlign: 'center'});                      $('#ss_c/span:eq(0)').text(s.image+' ');                      $('#ss_c/span:eq(2)').text(' '+s.of+' ');                      $('#ss_x').attr('title', s.ac).text(s.close).css({top: s.ns, right: s.ns*2}).bind('click', function(){                          remove();                          return false;                      });                      $('#ss_p').attr('title', s.ap).text(s.prev).css({bottom: s.ns, left: s.ns*2}).bind('click', function(){                          moveprev();                          return false;                      });                      $('#ss_n').attr('title', s.an).text(s.next).css({bottom: s.ns, right: s.ns*2}).bind('click', function(){                          movenext();                          return false;                      });                      $('#ss_o').css({position: 'fixed', zIndex: s.oz, opacity: 0, background: s.oc}).fadeTo('normal', s.oy, function(){                          $('#ss_s').fadeTo('normal', 1);                      });                      position();                      load(i, g);                       $(document).bind('keydown', function(e){                          var key = e.which || e.keyCode || e.charCode;                          switch (key){                              case 27: // [esc]                                  remove();                                  break;                              case 37: // [left arrow]                                  moveprev();                                  break;                              case 39: // [right arrow]                                  movenext();                                  break;                          }                      });                  return false;               });          });      }  };  })(jQuery); 